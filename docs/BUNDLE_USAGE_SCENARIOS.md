# Bundleç±»å‹ä½¿ç”¨éœ€æ±‚åˆ†æ

## ä½¿ç”¨éœ€æ±‚æ˜ å°„

åŸºäºå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œä¸‰ç§Bundleç±»å‹åˆ†åˆ«æ»¡è¶³ä¸åŒçš„ä½¿ç”¨éœ€æ±‚ï¼š

```
ä¸šåŠ¡éœ€æ±‚å±‚æ¬¡     â†’    Bundleç±»å‹     â†’    ç‰¹å¾
ç”Ÿäº§éƒ¨ç½²         â†’    Release       â†’    é•¿æœŸç¨³å®š
å®šæœŸåä½œ         â†’    Weekly        â†’    å›ºå®šèŠ‚æ‹  
ä¸´æ—¶éªŒè¯         â†’    Snapshots     â†’    å¿«é€Ÿçµæ´»
```

## 1. Release Bundle - æ­£å¼å‘å¸ƒç‰ˆæœ¬

### ä½¿ç”¨åœºæ™¯
- **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²** - ä¸¥æ ¼è´¨é‡æ§åˆ¶çš„ç”Ÿäº§æ•°æ®ç‰ˆæœ¬
- **å®¢æˆ·äº¤ä»˜** - å‘å¤–éƒ¨å®¢æˆ·äº¤ä»˜çš„æ•°æ®åŒ…
- **é‡Œç¨‹ç¢‘å‘å¸ƒ** - é‡å¤§åŠŸèƒ½æ›´æ–°çš„æ­£å¼ç‰ˆæœ¬
- **é•¿æœŸæ”¯æŒ** - éœ€è¦ç»´æŠ¤å’Œæ”¯æŒçš„ç¨³å®šç‰ˆæœ¬

### ç›®æ ‡ç”¨æˆ·
- ç”Ÿäº§è¿ç»´å›¢é˜Ÿ
- äº§å“å‘å¸ƒç»ç†
- å®¢æˆ·äº¤ä»˜å›¢é˜Ÿ
- è´¨é‡ä¿è¯å›¢é˜Ÿ

### ç”Ÿå‘½å‘¨æœŸç‰¹å¾
```yaml
# å‘å¸ƒç‰ˆæœ¬ç‰¹å¾
lifecycle:
  planning_period: "2-4å‘¨"          # è§„åˆ’å‘¨æœŸé•¿
  quality_gates: "ä¸¥æ ¼"             # å¤šé‡è´¨é‡é—¨æ§
  support_duration: "6-12ä¸ªæœˆ"       # é•¿æœŸæ”¯æŒ
  backward_compatibility: "å¿…é¡»"     # å¿…é¡»å‘åå…¼å®¹
  approval_required: true           # éœ€è¦æ­£å¼å®¡æ‰¹
```

### å®é™…éœ€æ±‚ç¤ºä¾‹

**åœºæ™¯1ï¼šè‡ªåŠ¨é©¾é©¶ç³»ç»Ÿv2.0å‘å¸ƒ**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šæ–°ç®—æ³•æ­£å¼ä¸Šçº¿ï¼Œéœ€è¦ä¸¥æ ¼éªŒè¯çš„æ•°æ®ç‰ˆæœ¬
python scripts/bundle_generator.py \
  --consumer consumers/autonomous_driving/v2.0.0.yaml \
  --type release

# ç”Ÿæˆï¼šbundles/release/autonomous_driving-v2.0.0.yaml
# ç‰¹ç‚¹ï¼šç»è¿‡å®Œæ•´QAæµç¨‹ï¼Œæ”¯æŒ1å¹´ï¼Œæœ‰å›æ»šè®¡åˆ’
```

**åœºæ™¯2ï¼šå®¢æˆ·äº¤ä»˜æ•°æ®åŒ…**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šå‘è½¦å‚å®¢æˆ·äº¤ä»˜è®­ç»ƒæ•°æ®åŒ…
python scripts/bundle_generator.py \
  --consumer consumers/customer_delivery/oem_a.yaml \
  --type release

# ç”Ÿæˆï¼šbundles/release/oem_a-v1.3.0.yaml  
# ç‰¹ç‚¹ï¼šæ•°æ®å®Œæ•´æ€§éªŒè¯ï¼Œæ³•å¾‹åˆè§„æ£€æŸ¥ï¼Œé•¿æœŸç»´æŠ¤
```

## 2. Weekly Bundle - å›ºå®šå‘¨æœŸç‰ˆæœ¬

### ä½¿ç”¨åœºæ™¯
- **å›¢é˜Ÿåä½œåŒæ­¥** - ä¿è¯å›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„æ•°æ®ç‰ˆæœ¬
- **å®šæœŸè®­ç»ƒä»»åŠ¡** - æ¯å‘¨å®šæœŸçš„æ¨¡å‹è®­ç»ƒ
- **é›†æˆæµ‹è¯•ç¯å¢ƒ** - æŒç»­é›†æˆçš„æ ‡å‡†æ•°æ®ç¯å¢ƒ
- **è¿›åº¦åŒæ­¥èŠ‚ç‚¹** - é¡¹ç›®è¿›åº¦çš„æ•°æ®ç‰ˆæœ¬é‡Œç¨‹ç¢‘

### ç›®æ ‡ç”¨æˆ·
- ç®—æ³•å¼€å‘å›¢é˜Ÿ
- æ¨¡å‹è®­ç»ƒå·¥ç¨‹å¸ˆ
- é›†æˆæµ‹è¯•å›¢é˜Ÿ
- é¡¹ç›®ç®¡ç†äººå‘˜

### ç”Ÿå‘½å‘¨æœŸç‰¹å¾
```yaml
# å‘¨çº§ç‰ˆæœ¬ç‰¹å¾
lifecycle:
  generation_schedule: "æ¯å‘¨ä¸€10:00"   # å›ºå®šç”Ÿæˆæ—¶é—´
  retention_period: "4å‘¨"            # ä¿ç•™4ä¸ªç‰ˆæœ¬
  stability_level: "æµ‹è¯•ç¨³å®š"         # é€‚åˆå¼€å‘æµ‹è¯•
  auto_generation: true              # è‡ªåŠ¨ç”Ÿæˆ
  team_notification: true            # è‡ªåŠ¨é€šçŸ¥å›¢é˜Ÿ
```

### å®é™…éœ€æ±‚ç¤ºä¾‹

**åœºæ™¯1ï¼šç«¯åˆ°ç«¯å›¢é˜Ÿå‘¨ä¾‹ä¼š**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šæ¯å‘¨ä¸€å›¢é˜Ÿä¾‹ä¼šå‰ï¼Œç”Ÿæˆç»Ÿä¸€çš„æ•°æ®ç‰ˆæœ¬
# è‡ªåŠ¨ä»»åŠ¡ï¼šæ¯å‘¨ä¸€ä¸Šåˆ10:00è‡ªåŠ¨æ‰§è¡Œ
python scripts/bundle_generator.py \
  --consumer consumers/end_to_end/latest.yaml \
  --type weekly

# ç”Ÿæˆï¼šbundles/weekly/end_to_end-2025.25.yaml
# å›¢é˜Ÿæ”¶åˆ°é€šçŸ¥ï¼šğŸ“… Weekly Bundle 2025.25 å·²ç”Ÿæˆï¼Œè¯·æ›´æ–°æœ¬åœ°ç¯å¢ƒ
```

**åœºæ™¯2ï¼šæ¨¡å‹è®­ç»ƒPipeline**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šæ¯å‘¨å®šæœŸè®­ç»ƒæ¨¡å‹ï¼Œä½¿ç”¨å›ºå®šçš„æ•°æ®ç‰ˆæœ¬åŸºçº¿
# CI/CD Pipelineä¸­ä½¿ç”¨
dataspec load --bundle bundles/weekly/perception_training-2025.25.yaml
python train_model.py --config weekly_training.yaml

# ç»“æœï¼šæ¯å‘¨è®­ç»ƒç»“æœå¯å¯¹æ¯”ï¼Œæ•°æ®ç‰ˆæœ¬ä¸€è‡´æ€§ä¿è¯
```

**åœºæ™¯3ï¼šå¤šå›¢é˜Ÿåä½œ**
```yaml
# å›¢é˜Ÿåä½œåœºæ™¯
teams:
  perception_team:
    usage: "ä½¿ç”¨weekly bundleè¿›è¡Œç®—æ³•å¼€å‘"
    sync_schedule: "æ¯å‘¨ä¸€æ£€æŸ¥æ–°ç‰ˆæœ¬"
    
  training_team:
    usage: "åŸºäºweekly bundleè¿›è¡Œæ¨¡å‹è®­ç»ƒ"
    dependency: "perception_teamçš„ç®—æ³•æ›´æ–°"
    
  testing_team:
    usage: "ä½¿ç”¨weekly bundleè¿›è¡Œå›å½’æµ‹è¯•"
    trigger: "æ–°weekly bundleç”Ÿæˆå24å°æ—¶å†…"
```

## 3. Snapshots Bundle - ä¸´æ—¶å¿«ç…§ç‰ˆæœ¬

### ä½¿ç”¨åœºæ™¯
- **å¿«é€ŸéªŒè¯å®éªŒ** - ä¸´æ—¶æ•°æ®éœ€æ±‚çš„å¿«é€Ÿå“åº”
- **POCæ¦‚å¿µéªŒè¯** - æ–°æƒ³æ³•çš„å¿«é€Ÿè¯•éªŒ
- **Bugè°ƒè¯•** - ç‰¹å®šé—®é¢˜çš„æ•°æ®é‡ç°
- **ä¸´æ—¶éœ€æ±‚** - ç´§æ€¥æˆ–çŸ­æœŸçš„æ•°æ®éœ€æ±‚

### ç›®æ ‡ç”¨æˆ·
- ç®—æ³•ç ”ç©¶å‘˜
- å®éªŒå·¥ç¨‹å¸ˆ
- é—®é¢˜è°ƒè¯•äººå‘˜
- ä¸šåŠ¡åˆ†æå¸ˆ

### ç”Ÿå‘½å‘¨æœŸç‰¹å¾
```yaml
# å¿«ç…§ç‰ˆæœ¬ç‰¹å¾
lifecycle:
  creation_time: "å³æ—¶"              # éšæ—¶åˆ›å»º
  ttl: "7-30å¤©"                    # çŸ­æœŸæœ‰æ•ˆ
  auto_cleanup: true               # è‡ªåŠ¨æ¸…ç†
  approval_required: false         # æ— éœ€å®¡æ‰¹
  purpose_tracking: true           # ç”¨é€”è¿½è¸ª
```

### å®é™…éœ€æ±‚ç¤ºä¾‹

**åœºæ™¯1ï¼šç®—æ³•ç ”ç©¶å‘˜çš„æ–°æƒ³æ³•éªŒè¯**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šæƒ³æµ‹è¯•æ–°çš„èåˆç®—æ³•ï¼Œéœ€è¦ç‰¹å®šçš„æ•°æ®ç»„åˆ
python scripts/bundle_generator.py \
  --consumer consumers/experiments/radar_fusion_test.yaml \
  --type snapshot

# ç”Ÿæˆï¼šbundles/snapshots/radar_fusion_test-20250620-143500.yaml
# ç‰¹ç‚¹ï¼š7å¤©åè‡ªåŠ¨æ¸…ç†ï¼Œç”¨é€”æ˜ç¡®æ ‡è®°
```

**åœºæ™¯2ï¼šç´§æ€¥Bugè°ƒè¯•**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šç”Ÿäº§ç¯å¢ƒå‡ºç°é—®é¢˜ï¼Œéœ€è¦å¤ç°ç‰¹å®šç‰ˆæœ¬ç»„åˆ
# ä¸´æ—¶åˆ›å»ºconsumeré…ç½®
cat > consumers/debug/emergency_debug.yaml << EOF
meta:
  consumer: emergency_debug
  purpose: "å¤ç°ç”Ÿäº§ç¯å¢ƒIssue #1234"
requirements:
  - channel: image_original
    version: "1.1.8"  # å‡ºé—®é¢˜æ—¶çš„ç‰ˆæœ¬
  - channel: object_array_fusion_infer  
    version: "1.1.9"  # å‡ºé—®é¢˜æ—¶çš„ç‰ˆæœ¬
EOF

python scripts/bundle_generator.py \
  --consumer consumers/debug/emergency_debug.yaml \
  --type snapshot

# ç”Ÿæˆï¼šbundles/snapshots/emergency_debug-20250620-153000.yaml
# ç”¨äºï¼šæœ¬åœ°å¤ç°é—®é¢˜ï¼Œæ‰¾åˆ°æ ¹å› åæ¸…ç†
```

**åœºæ™¯3ï¼šä¸šåŠ¡å›¢é˜Ÿä¸´æ—¶æ•°æ®éœ€æ±‚**
```bash
# ä½¿ç”¨éœ€æ±‚ï¼šå¸‚åœºå›¢é˜Ÿéœ€è¦ç‰¹å®šåœºæ™¯çš„æ•°æ®è¿›è¡Œåˆ†æ
python scripts/bundle_generator.py \
  --consumer consumers/business/market_analysis_temp.yaml \
  --type snapshot

# ç‰¹ç‚¹ï¼š
# - æ— éœ€èµ°æ­£å¼æµç¨‹
# - 2å‘¨åè‡ªåŠ¨è¿‡æœŸ
# - æ•°æ®ä½¿ç”¨æœ‰å®¡è®¡è®°å½•
```

## ä½¿ç”¨å†³ç­–æ ‘

```
æ•°æ®éœ€æ±‚åˆ†æ
â”œâ”€â”€ ç”¨é€”æœŸé™ï¼Ÿ
â”‚   â”œâ”€â”€ é•¿æœŸä½¿ç”¨(>3ä¸ªæœˆ) â†’ Release Bundle
â”‚   â”œâ”€â”€ å®šæœŸä½¿ç”¨(å‘¨æœŸæ€§) â†’ Weekly Bundle  
â”‚   â””â”€â”€ çŸ­æœŸä½¿ç”¨(<1ä¸ªæœˆ) â†’ Snapshots Bundle
â”‚
â”œâ”€â”€ è´¨é‡è¦æ±‚ï¼Ÿ
â”‚   â”œâ”€â”€ ç”Ÿäº§çº§åˆ« â†’ Release Bundle
â”‚   â”œâ”€â”€ å¼€å‘çº§åˆ« â†’ Weekly Bundle
â”‚   â””â”€â”€ å®éªŒçº§åˆ« â†’ Snapshots Bundle
â”‚
â””â”€â”€ å®¡æ‰¹æµç¨‹ï¼Ÿ
    â”œâ”€â”€ éœ€è¦æ­£å¼å®¡æ‰¹ â†’ Release Bundle
    â”œâ”€â”€ å›¢é˜Ÿå†…åè°ƒ â†’ Weekly Bundle
    â””â”€â”€ ä¸ªäºº/å°ç»„ä½¿ç”¨ â†’ Snapshots Bundle
```

## ç®¡ç†ç­–ç•¥

### è‡ªåŠ¨åŒ–ç®¡ç†
```bash
# Weekly Bundle - è‡ªåŠ¨ç”Ÿæˆ
# crontab: 0 10 * * 1  # æ¯å‘¨ä¸€10:00
/scripts/auto_weekly_bundle.sh

# Snapshots - è‡ªåŠ¨æ¸…ç†  
# crontab: 0 2 * * *   # æ¯å¤©å‡Œæ™¨2:00
/scripts/cleanup_expired_snapshots.sh

# Release - æ‰‹åŠ¨ç®¡ç†ï¼Œä¸¥æ ¼æ§åˆ¶
# éœ€è¦é€šè¿‡æ­£å¼çš„å‘å¸ƒæµç¨‹
```

### ç›‘æ§å‘Šè­¦
```yaml
monitoring:
  weekly_bundle:
    alert_if: "ç”Ÿæˆå¤±è´¥æˆ–å»¶è¿Ÿè¶…è¿‡30åˆ†é’Ÿ"
    notification: "team-channel"
    
  snapshots:
    alert_if: "æ•°é‡è¶…è¿‡50ä¸ª"
    action: "æé†’æ¸…ç†æ—§å¿«ç…§"
    
  release:
    alert_if: "è´¨é‡æ£€æŸ¥å¤±è´¥"  
    action: "é˜»æ­¢å‘å¸ƒï¼Œé€šçŸ¥ç›¸å…³äººå‘˜"
```

## æ€»ç»“

ä¸‰ç§Bundleç±»å‹å½¢æˆäº†å®Œæ•´çš„æ•°æ®ç‰ˆæœ¬ç®¡ç†ä½“ç³»ï¼š

- **Release**: ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šåŸºçŸ³
- **Weekly**: å›¢é˜Ÿåä½œçš„åŒæ­¥èŠ‚æ‹  
- **Snapshots**: æ•æ·å¼€å‘çš„çµæ´»å·¥å…·

é€šè¿‡è¿™ç§åˆ†å±‚è®¾è®¡ï¼Œæ—¢ä¿è¯äº†ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šæ€§ï¼Œåˆæ»¡è¶³äº†å¼€å‘è¿‡ç¨‹ä¸­çš„çµæ´»æ€§éœ€æ±‚ã€‚ 